---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Navbar from "../../components/Navbar.astro";
import Footer from "../../components/Footer.astro";
import { Image } from "astro:assets";
import { t } from "../../utils/i18n";

const lang = Astro.props.language || "en";
const translations = t(lang).products;
---

<BaseLayout
    title={translations.meta.title}
    description={translations.meta.description}
>
    <Navbar />
    <section class="relative">
        <!-- Background Image -->
        <div class="absolute inset-0">
            <Image
                src={import("../../assets/products/bg.jpg")}
                fetchpriority={"high"}
                alt={translations.hero.bgAlt}
                class="w-full h-full object-cover"
                loading="eager"
                width={1920}
                height={600}
            />

            <!-- Beige tint overlay -->
            <div class="absolute inset-0 bg-[#d8c9a6]/80"></div>
        </div>

        <!-- CONTENT -->
        <div class="relative max-w-9xl mx-auto px-6 lg:px-12 py-16 lg:py-24">
            <div class="grid md:grid-cols-[2fr_1fr] gap-10 items-center">
                <!-- LEFT TEXT -->
                <div>
                    <h2
                        class="text-3xl md:text-4xl lg:text-6xl font-bold text-[#2b2623] mb-4 reveal"
                    >
                        {translations.hero.heading}
                    </h2>

                    <h3
                        class="text-lg md:text-xl lg:text-3xl font-semibold mb-4 text-[#2b2623] reveal"
                    >
                        {translations.hero.subheading}
                    </h3>

                    <p
                        class="text-sm md:text-base lg:text-xl leading-tight max-w-4xl text-[#3f3a36] reveal"
                    >
                        {translations.hero.description}
                    </p>
                </div>

                <!-- RIGHT IMAGE -->
                <div class="flex justify-center md:justify-end">
                    <Image
                        src={import("../../assets/products/banner-coil.png")}
                        alt={translations.hero.bannerAlt}
                        class="w-48 md:w-56 lg:w-64 object-cover shadow-md reveal-right"
                        loading="eager"
                        width={256}
                        height={256}
                    />
                </div>
            </div>
        </div>
    </section>

    <section class="bg-[#e3d7b8] p-8">
        <div class="bg-[#7fa99a]">
            <div class="max-w-9xl mx-auto px-6 lg:px-12 p-12">
                <!-- GRID -->
                <div class="mb-12">
                    <h3
                        class="text-xl md:text-3xl lg:text-4xl font-bold mb-4 text-[#1f1f1f] reveal"
                    >
                        {translations.aromas.heading}
                    </h3>

                    <p
                        class="text-sm md:text-base lg:text-2xl leading-tight text-[#2f2f2f] reveal"
                    >
                        {translations.aromas.description}
                    </p>
                </div>
                <div class="grid gap-10 items-center">
                    <!-- LEFT TEXT -->

                    <!-- AROMA ITEMS -->
                    <div
                        class="md:col-span-4 grid grid-cols-2 md:grid-cols-4 gap-8 text-center"
                    >
                        <!-- ITEM -->
                        <div class="reveal">
                            <Image
                                src={import("../../assets/products/coil-red.png")}
                                alt={translations.aromas.items[0].alt}
                                class="mx-auto mb-3 w-200"
                                loading="lazy"
                                width={300}
                                height={300}
                            />
                            <p class="font-semibold text-2xl">{translations.aromas.items[0].label}</p>
                        </div>

                        <!-- ITEM -->
                        <div class="reveal">
                            <Image
                                src={import("../../assets/products/coil-green.png")}
                                alt={translations.aromas.items[1].alt}
                                class="mx-auto mb-3 w-200"
                                loading="lazy"
                                width={300}
                                height={300}
                            />
                            <p class="font-semibold text-2xl">{translations.aromas.items[1].label}</p>
                        </div>
                        <!-- ITEM -->
                        <div class="reveal">
                            <Image
                                src={import("../../assets/products/coil-purple.png")}
                                alt={translations.aromas.items[2].alt}
                                class="mx-auto mb-3 w-200"
                                loading="lazy"
                                width={300}
                                height={300}
                            />
                            <p class="font-semibold text-2xl">
                                {translations.aromas.items[2].label}
                            </p>
                        </div>

                        <!-- ITEM -->
                        <div class="reveal">
                            <Image
                                src={import("../../assets/products/coil-brown.png")}
                                alt={translations.aromas.items[3].alt}
                                class="mx-auto mb-3 w-200"
                                loading="lazy"
                                width={300}
                                height={300}
                            />
                            <p class="font-semibold text-2xl">{translations.aromas.items[3].label}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="bg-[#e3d7b8] p-8">
        <div class="bg-[#7fa99a]">
            <div class="max-w-9xl mx-auto p-12">
                <!-- RIGHT: TEXT -->
                <div>
                    <h3
                        class="text-xl md:text-3xl lg:text-4xl font-bold mb-4 text-[#1f1f1f] reveal"
                    >
                        {translations.packing.heading}
                    </h3>

                    <p class="text-sm font-semibold mb-4 text-[#3f3a36] reveal">
                        {translations.packing.subheading}
                    </p>

                    <p
                        class="text-sm md:text-base lg:text-2xl leading-tight text-[#2f2f2f] reveal"
                    >
                        {translations.packing.description}
                    </p>
                </div>
                <!-- LEFT: PACKING ITEMS -->
                <div
                    class="grid grid-cols-1 sm:grid-cols-3 gap-10 text-center mt-12"
                >
                    <!-- Item -->
                    <div class="reveal-left">
                        <Image
                            src={import("../../assets/products/box-tin-can.png")}
                            alt={translations.packing.items[0].alt}
                            class="mx-auto mb-4 w-80"
                            loading="lazy"
                            width={400}
                            height={400}
                        />
                        <p class="font-semibold text-[#2b2623]">{translations.packing.items[0].label}</p>
                    </div>

                    <!-- Item -->
                    <div class="reveal">
                        <Image
                            src={import("../../assets/products/box-coil-holder.png")}
                            alt={translations.packing.items[1].alt}
                            class="mx-auto mb-4 w-80"
                            loading="lazy"
                            width={400}
                            height={400}
                        />
                        <p class="font-semibold text-[#2b2623]">{translations.packing.items[1].label}</p>
                    </div>

                    <!-- Item -->
                    <div class="reveal-right">
                        <Image
                            src={import("../../assets/products/box-dispenser.png")}
                            alt={translations.packing.items[2].alt}
                            class="mx-auto mb-4 w-80"
                            loading="lazy"
                            width={400}
                            height={400}
                        />
                        <p class="font-semibold text-[#2b2623]">
                            {translations.packing.items[2].label}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="bg-[#e3d7b8] p-12">
        <div class="bg-[#d6c6a5]">
            <div class="max-w-9xl mx-auto p-12">
                <div
                    class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-12 text-center"
                >
                    <!-- ITEM -->
                    <div class="reveal">
                        <Image
                            src={import("../../assets/products/base-smokeless.jpg")}
                            alt={translations.bases[0].alt}
                            class="mx-auto mb-6 object-cover"
                            loading="lazy"
                            width={300}
                            height={300}
                        />
                        <div
                            class="bg-[#7fa99a] text-[#1f1f1f] font-semibold py-4 px-8 rounded-xl inline-block text-3xl min-w-[180px]"
                        >
                            {translations.bases[0].label}
                        </div>
                    </div>

                    <!-- ITEM -->
                    <div class="reveal">
                        <Image
                            src={import("../../assets/products/base-wood.jpg")}
                            alt={translations.bases[1].alt}
                            class="mx-auto mb-6 object-cover"
                            loading="lazy"
                            width={300}
                            height={300}
                        />
                        <div
                            class="bg-[#7fa99a] text-[#1f1f1f] font-semibold py-4 px-8 text-3xl rounded-xl inline-block min-w-[180px]"
                        >
                            {translations.bases[1].label}
                        </div>
                    </div>

                    <!-- ITEM -->
                    <div class="reveal">
                        <Image
                            src={import("../../assets/products/base-charcoal.jpg")}
                            alt={translations.bases[2].alt}
                            class="mx-auto mb-6 object-cover"
                            loading="lazy"
                            width={300}
                            height={300}
                        />
                        <div
                            class="bg-[#7fa99a] text-[#1f1f1f] font-semibold py-4 px-8 text-3xl rounded-xl inline-block min-w-[180px]"
                        >
                            {translations.bases[2].label}
                        </div>
                    </div>

                    <!-- ITEM -->
                    <div class="reveal">
                        <Image
                            src={import("../../assets/products/base-pre-mix-powder.jpg")}
                            alt={translations.bases[3].alt}
                            class="mx-auto mb-6 object-cover"
                            loading="lazy"
                            width={300}
                            height={300}
                        />
                        <div
                            class="bg-[#7fa99a] text-[#1f1f1f] font-semibold py-4 px-8 text-3xl rounded-xl inline-block min-w-[180px]"
                        >
                            {translations.bases[3].label}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="bg-[#7fa99a] text-white py-16 overflow-hidden">
        <div class="max-w-9xl mx-auto px-6">
            <!-- CAROUSEL -->
            <div class="carousel relative select-none overflow-hidden">
                <!-- VIEWPORT -->
                <div class="overflow-hidden w-full h-full">
                    <!-- TRACK -->
                    <div class="carousel-track flex h-full">
                        <!-- SLIDE 1 -->
                        <div
                            class="slide flex-shrink-0 w-full h-full flex flex-col justify-center text-center px-6 md:px-20"
                        >
                            <h2
                                class="text-3xl md:text-6xl font-bold mb-3 text-shadow-sm text-shadow-gray-700"
                            >
                                {translations.carousel.smokeless.heading}
                            </h2>

                            <h3
                                class="text-3xl font-semibold text-shadow-sm text-shadow-sm text-shadow-gray-700"
                            >
                                {translations.carousel.smokeless.subheading}
                            </h3>

                            <p
                                class="max-w-8xl mx-auto my-10 md:my-20 opacity-90 md:text-2xl leading-tight text-center text-shadow-lg"
                            >
                                {translations.carousel.smokeless.description}
                            </p>

                            <ul
                                class="inline-block text-center space-y-1 opacity-90 md:text-2xl leading-tight text-shadow-lg"
                            >
                                {translations.carousel.smokeless.benefits.map((benefit: string) => (
                                    <li>• {benefit}</li>
                                ))}
                            </ul>
                        </div>

                        <!-- SLIDE 2 -->
                        <div
                            class="slide flex-shrink-0 w-full h-full flex flex-col justify-center text-center px-6 md:px-20"
                        >
                            <h2
                                class="text-3xl md:text-6xl font-bold mb-3 text-shadow-sm text-shadow-gray-700"
                            >
                                {translations.carousel.wood.heading}
                            </h2>

                            <h3
                                class="text-3xl font-semibold text-shadow-sm text-shadow-gray-700"
                            >
                                {translations.carousel.wood.subheading}
                            </h3>

                            <p
                                class="max-w-8xl mx-auto my-10 md:my-20 opacity-90 md:text-2xl leading-tight text-center text-shadow-lg"
                            >
                                {translations.carousel.wood.description}
                            </p>

                            <ul
                                class="inline-block text-center space-y-1 opacity-90 md:text-2xl leading-tight text-shadow-lg"
                            >
                                {translations.carousel.wood.benefits.map((benefit: string) => (
                                    <li>• {benefit}</li>
                                ))}
                            </ul>
                        </div>

                        <!-- SLIDE 3 -->
                        <div
                            class="slide flex-shrink-0 w-full h-full flex flex-col justify-center text-center px-6 md:px-20"
                        >
                            <h2
                                class="text-3xl md:text-6xl font-bold mb-3 text-shadow-sm text-shadow-gray-700"
                            >
                                {translations.carousel.charcoal.heading}
                            </h2>

                            <h3
                                class="text-3xl font-semibold text-shadow-sm text-shadow-gray-700"
                            >
                                {translations.carousel.charcoal.subheading}
                            </h3>

                            <p
                                class="max-w-8xl mx-auto my-10 md:my-20 opacity-90 md:text-2xl leading-tight text-center text-shadow-lg"
                            >
                                {translations.carousel.charcoal.description}
                            </p>

                            <ul
                                class="inline-block text-center space-y-1 opacity-90 md:text-2xl leading-tight text-shadow-lg"
                            >
                                {translations.carousel.charcoal.benefits.map((benefit: string) => (
                                    <li>• {benefit}</li>
                                ))}
                            </ul>
                        </div>

                        <!-- SLIDE 4 -->
                        <div
                            class="slide flex-shrink-0 w-full h-full flex flex-col justify-center text-center px-6 md:px-20"
                        >
                            <h2
                                class="text-3xl md:text-6xl font-bold mb-3 text-shadow-sm text-shadow-gray-700"
                            >
                                {translations.carousel.premix.heading}
                            </h2>

                            <h3
                                class="text-3xl font-semibold text-shadow-sm text-shadow-gray-700"
                            >
                                {translations.carousel.premix.subheading}
                            </h3>

                            <p
                                class="max-w-8xl mx-auto my-10 md:my-20 opacity-90 md:text-2xl leading-tight text-center text-shadow-lg"
                            >
                                {translations.carousel.premix.description}
                            </p>

                            <p
                                class="md:text-2xl font-semibold text-shadow-lg mb-4"
                            >
                                {translations.carousel.premix.challengesHeading}
                            </p>

                            <ul
                                class="inline-block text-center space-y-1 opacity-90 md:text-2xl leading-tight text-shadow-lg"
                            >
                                {translations.carousel.premix.challenges.map((challenge: string) => (
                                    <li>• {challenge}</li>
                                ))}
                            </ul>

                            <ul
                                class="inline-block text-center space-y-1 opacity-90 md:text-2xl leading-tight text-shadow-lg mt-8"
                            >
                                {translations.carousel.premix.benefits.map((benefit: string) => (
                                    <li>• {benefit}</li>
                                ))}
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- ARROWS -->
                <button
                    class="prev absolute left-0 top-1/2 -translate-y-1/2 opacity-70 hover:opacity-100 z-10"
                    aria-label={translations.navigation.prevAria}
                >
                    <Image
                        src={import("../../assets/products/left-arrow.png")}
                        alt={translations.navigation.prevAlt}
                        class="w-6 md:w-12"
                        loading="lazy"
                        width={48}
                        height={48}
                    />
                </button>

                <button
                    class="next absolute right-0 top-1/2 -translate-y-1/2 opacity-70 hover:opacity-100 z-10"
                    aria-label={translations.navigation.nextAria}
                >
                    <Image
                        src={import("../../assets/products/right-arrow.png")}
                        alt={translations.navigation.nextAlt}
                        class="w-6 md:w-12"
                        loading="lazy"
                        width={48}
                        height={48}
                    />
                </button>
            </div>
        </div>
    </section>

    <section class="bg-[#d6c6a5] py-20 lg:py-28">
        <div class="max-w-5xl mx-auto px-6 text-center">
            <!-- HEADLINE -->
            <h2
                class="text-3xl md:text-4xl lg:text-6xl font-bold text-[#2b2623] leading-tight mb-10 reveal"
            >
                {translations.cta.heading}
            </h2>

            <!-- BUTTON -->
            <a
                href="/en/contact"
                class="inline-block bg-[#1f1f1f] text-white px-8 py-3 rounded-md text-md md:text-lg hover:opacity-90 transition reveal"
                aria-label={translations.cta.buttonAria}
            >
                {translations.cta.button}
            </a>
        </div>
    </section>

    <Footer />
</BaseLayout>

<style>
    /* Reveal Animations */
    .reveal,
    .reveal-left,
    .reveal-right {
        opacity: 0;
        transition: all 0.9s ease;
    }

    .reveal {
        transform: translateY(40px);
    }

    .reveal-left {
        transform: translateX(-80px);
    }

    .reveal-right {
        transform: translateX(80px);
    }

    /* Show state */
    .reveal.show,
    .reveal-left.show,
    .reveal-right.show {
        opacity: 1;
        transform: translate(0, 0);
    }
</style>

<script>
    // Reveal animations observer
    const revealObserver = new IntersectionObserver(
        (entries) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    entry.target.classList.add("show");
                }
            });
        },
        { threshold: 0.2 },
    );

    document
        .querySelectorAll(".reveal, .reveal-left, .reveal-right")
        .forEach((el) => revealObserver.observe(el));

    // Carousel functionality
    const track = document.querySelector(".carousel-track");
    const slides = document.querySelectorAll(".slide");
    const nextBtn = document.querySelector(".next");
    const prevBtn = document.querySelector(".prev");

    let index = 0;
    let startX = 0;
    let currentX = 0;
    let isDragging = false;
    if (!track) throw new Error("Carousel track not found");
    track.style.willChange = "transform";

    const slideWidth = () => slides[0].offsetWidth;

    function update(animate = true) {
        track.style.transition = animate
            ? "transform .6s cubic-bezier(.22,1,.36,1)"
            : "none";

        track.style.transform = `translateX(-${index * slideWidth()}px)`;
    }

    function next() {
        index = (index + 1) % slides.length;
        update();
    }

    function prev() {
        index = (index - 1 + slides.length) % slides.length;
        update();
    }

    nextBtn.onclick = next;
    prevBtn.onclick = prev;

    // DRAG / SWIPE
    track.addEventListener("pointerdown", (e) => {
        isDragging = true;
        startX = e.clientX;
        currentX = 0;
        update(false);
    });

    window.addEventListener("pointermove", (e) => {
        if (!isDragging) return;
        currentX = e.clientX - startX;

        track.style.transform = `translateX(${currentX - index * slideWidth()}px)`;
    });

    window.addEventListener("pointerup", () => {
        if (!isDragging) return;
        isDragging = false;

        if (currentX < -60) next();
        else if (currentX > 60) prev();
        else update();

        currentX = 0;
    });

    // AUTO PLAY
    setInterval(next, 6000);

    // RESPONSIVE FIX
    window.addEventListener("resize", () => update(false));
</script>
